<div class="notifications-page">
  <div class="notifications-container">
    <!-- Header -->
    <div class="page-header">
      <div class="header-top">
        <button class="btn-back" (click)="goBack()">
          <span class="back-icon">‚Üê</span>
          Back to Feed
        </button>
      </div>

      <div class="header-content">
        <h1 class="page-title">Notifications</h1>
        <p class="page-subtitle">Stay updated with your latest activity</p>
      </div>

      @if (notifications().length > 0 && hasUnread()) {
        <button class="btn-mark-all-read" (click)="markAllAsRead()">
          Mark all as read
        </button>
      }
    </div>

    <!-- Loading State -->
    @if (loading()) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Loading notifications...</p>
      </div>
    }

    <!-- Error State -->
    @if (error() && !loading()) {
      <div class="error-state">
        <p>{{ error() }}</p>
      </div>
    }

    <!-- Notifications List -->
    @if (!loading() && !error()) {
      @if (notifications().length === 0) {
        <div class="empty-state">
          <div class="empty-icon">üîî</div>
          <h2>No notifications yet</h2>
          <p>When someone follows you, likes your posts, or comments, you'll see it here.</p>
        </div>
      } @else {
        <div class="notifications-list">
          @for (notification of notifications(); track notification.id) {
            <div
              class="notification-item"
              [class.unread]="!notification.read"
              (click)="handleNotificationClick(notification)">

              <div class="notification-avatar">
                @if (notification.actorAvatar && !isAvatarFailed(notification.actorAvatar)) {
                  <img
                    [src]="notification.actorAvatar"
                    [alt]="notification.actorUsername"
                    (error)="onAvatarError(notification.actorAvatar)">
                } @else {
                  <div class="avatar-placeholder">
                    {{ notification.actorUsername.charAt(0).toUpperCase() }}
                  </div>
                }
              </div>

              <div class="notification-content">
                <div class="notification-icon" [innerHTML]="getNotificationIconSvg(notification.type)"></div>
                <p class="notification-message">{{ notification.message }}</p>
                <span class="notification-time">{{ getTimeAgo(notification.createdAt) }}</span>
              </div>

              @if (!notification.read) {
                <button
                  class="btn-mark-read"
                  (click)="markAsRead(notification, $event)"
                  title="Mark as read">
                  √ó
                </button>
              }
            </div>
          }
        </div>
      }
    }
  </div>
</div>
